<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ElectronicAI.ca - Bridging Electronics and Artificial Intelligence</title>
    <meta name="description"
        content="Explore the convergence of electronics and artificial intelligence at ElectronicAI.ca. Discover articles, projects, and insights into AI hardware, embedded AI, IoT, machine learning, and robotics.">
    <meta name="keywords"
        content="electronics, artificial intelligence, AI, embedded AI, IoT, machine learning, deep learning, robotics, AI hardware, microcontrollers, sensors, actuators, neural networks, computer vision, natural language processing, smart devices, automation, electronic circuits, AI applications, Canada AI, electronicai.ca">
    <meta name="author" content="ElectronicAI.ca Team">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://www.electronicai.ca/">

    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

</head>

<body>
    <div class="page-wrapper">
        <header>
            <h1>ElectronicAI.ca</h1>
            <p>Bridging the Gap Between Electronics and Artificial Intelligence</p>
            <a href="/history">
                <button class="view-history-btn">View History</button>
            </a>
            <a href="/logout">
                <button class="logout-btn">Logout</button>
            </a>
        </header>

        <main>
            <section class="chat-container">
                <div class="chat-history" id="chat-history">
                    <div class="message-bubble ai-message">
                        Hello! I'm your ElectronicAI assistant. Ask me anything about the exciting world where electronics
                        meets artificial intelligence.
                    </div>
                </div>
                <div class="typing-indicator" id="typing-indicator" style="display: none;">
                    <span></span><span></span><span></span>
                    AI is typing...
                </div>
                <div class="chat-input-area">
                    <input type="text" id="user-input" placeholder="Type your question here..." autocomplete="off">
                    <button id="send-button">Send</button>
                </div>
            </section>
        </main>
        
        <footer>
            <p>&copy; 2025 ElectronicAI.ca. All rights reserved.</p>
        </footer>
    </div>

    <script>
        const chatHistory = document.getElementById('chat-history');
        const userInput = document.getElementById('user-input');
        const sendButton = document.getElementById('send-button');
        const typingIndicator = document.getElementById('typing-indicator');

        /**
         * Adds a message bubble to the chat history.
         * @param {string} message - The text content of the message.
         * @param {string} sender - 'user' or 'ai' to determine styling.
         */
        function addMessage(message, sender) {
            const messageBubble = document.createElement('div');
            messageBubble.classList.add('message-bubble');
            messageBubble.classList.add(`${sender}-message`);
            messageBubble.textContent = message;
            chatHistory.appendChild(messageBubble);

            chatHistory.scrollTop = chatHistory.scrollHeight;
        }

        /**
         * Simulates AI typing by showing/hiding the typing indicator.
         * @param {boolean} show - True to show, false to hide.
         */
        function showTypingIndicator(show) {
            typingIndicator.style.display = show ? 'flex' : 'none';
            if (show) {
                // Scroll to bottom when typing indicator appears
                chatHistory.scrollTop = chatHistory.scrollHeight;
            }
        }

        /**
         * Sends the user's message to the Flask backend and handles the AI's response.
         */
        async function sendMessage() {
            const message = userInput.value.trim();
            if (message === '') {
                return;
            }

            addMessage(message, 'user');
            userInput.value = '';

            showTypingIndicator(true);

            try {
                const response = await fetch('/chat', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ message: message })
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const data = await response.json();
                showTypingIndicator(false);
                addMessage(data.response, 'ai');
            } catch (error) {
                console.error('Error sending message:', error);
                showTypingIndicator(false);
                addMessage("Oops! Something went wrong. Please try again.", 'ai');
            }
        }

        sendButton.addEventListener('click', sendMessage);

        userInput.addEventListener('keypress', function (event) {
            if (event.key === 'Enter') {
                sendMessage();
            }
        });

        window.onload = () => {
            chatHistory.scrollTop = chatHistory.scrollHeight;
        };
    </script>
</body>

</html>